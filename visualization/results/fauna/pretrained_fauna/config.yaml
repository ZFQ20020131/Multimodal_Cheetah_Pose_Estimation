run_train: false
run_test: true
seed: 0
gpu: 0
num_iters: 1
train_data_dir: null
val_data_dir: null
test_data_dir: null
checkpoint_dir: results/fauna/pretrained_fauna/
save_checkpoint_freq: 5000
keep_num_checkpoint: 2
archive_code: false
resume: true
checkpoint_name: pretrained_fauna.pth
test_result_dir: null
use_logger: true
log_image_freq: 500
log_loss_freq: 50
log_train: true
log_val: true
fix_log_batch: false
save_train_result_freq: 10000
disc_train: true
remake_dataloader_iter: -1
shuffle_dataset_paths: true
remake_dataloader_num: -1
dataset:
  data_type: sequence
  in_image_size: 256
  out_image_size: 256
  batch_size: 1
  num_workers: 4
  train_data_dir: null
  val_data_dir: null
  test_data_dir: data/fauna/Fauna_dataset/large_scale/bear_comb_dinov2_new/test
  random_shuffle_samples_train: true
  random_xflip_train: false
  load_flow: false
  background_mode: none
  load_dino_feature: true
  load_dino_cluster: false
  dino_feature_dim: 16
  skip_beginning: 0
  skip_end: 0
  num_frames: 1
  min_seq_len: 2
  random_sample_frames_train: false
  random_sample_frames_val: false
model:
  dataset: ${dataset}
  name: Fauna
  cfg_optim_base:
    lr: 0.001
    weight_decay: 0.0
  cfg_optim_instance:
    lr: 0.0001
    weight_decay: 0.0
  cfg_optim_discriminator:
    lr: 0.0001
    weight_decay: 0.0
  cfg_render:
    spatial_scale: 7
    background_mode: none
    render_flow: false
    cam_pos_z_offset: 10
    fov: 25
    renderer_spp: 1
  cfg_mask_discriminator:
    enable_iter:
    - 80000
    - 300000
  cfg_predictor_base:
    cfg_shape:
      grid_res: 256
      grid_res_coarse_iter_range:
      - 0
      - 500000
      grid_res_coarse: 128
      spatial_scale: ${...cfg_render.spatial_scale}
      num_layers: 5
      hidden_size: 256
      embedder_freq: 8
      embed_concat_pts: true
      init_sdf: ellipsoid
      jitter_grid: 0.05
      symmetrize: true
    cfg_dino:
      feature_dim: 16
      num_layers: 5
      hidden_size: 256
      activation: sigmoid
      embedder_freq: 8
      embed_concat_pts: true
      symmetrize: false
      minmax:
      - 0.0
      - 1.0
    cfg_bank:
      memory_bank_size: 60
  cfg_predictor_instance:
    spatial_scale: ${..cfg_render.spatial_scale}
    cfg_encoder:
      cout: 256
      which_vit: dino_vits8
      pretrained: true
      frozen: true
      final_layer_type: conv
    cfg_texture:
      texture_iter_range:
      - 0
      - 'inf'
      cout: 9
      num_layers: 8
      hidden_size: 256
      activation: sigmoid
      kd_minmax:
      - - 0.0
        - 1.0
      - - 0.0
        - 1.0
      - - 0.0
        - 1.0
      embed_concat_pts: true
      embedder_freq: 10
      symmetrize: true
    cfg_pose:
      architecture: encoder_dino_patch_key
      cam_pos_z_offset: ${...cfg_render.cam_pos_z_offset}
      fov: ${...cfg_render.fov}
      max_trans_xy_range_ratio: 0.2
      max_trans_z_range_ratio: 0.5
      rot_rep: quadlookat
      rot_temp_scalar: 1
      naive_probs_iter: 2000
      best_pose_start_iter: 6000
      lookat_zeroy: true
    enable_deform: true
    cfg_deform:
      deform_iter_range:
      - 800000
      - 'inf'
      num_layers: 5
      hidden_size: 256
      embed_concat_pts: true
      embedder_freq: 10
      symmetrize: true
    enable_articulation: true
    cfg_articulation:
      articulation_iter_range:
      - 20000
      - 'inf'
      architecture: attention
      num_layers: 4
      hidden_size: 256
      embedder_freq: 8
      bone_feature_mode: sample+global
      num_body_bones: 8
      body_bones_mode: z_minmax_y+
      num_legs: 4
      num_leg_bones: 3
      attach_legs_to_body_iter_range:
      - 60000
      - 'inf'
      legs_to_body_joint_indices: null
      static_root_bones: false
      skinning_temperature: 0.05
      max_arti_angle: 60
      constrain_legs: false
      output_multiplier: 0.1
      enable_refine: false
    enable_lighting: true
    cfg_light:
      num_layers: 5
      hidden_size: 256
      amb_diff_minmax:
      - - 0.0
        - 1.0
      - - 0.5
        - 1.0
    cfg_additional:
      iter_leg_rotation_start: 300000
  cfg_loss:
    mask_loss_weight: 100.0
    mask_dt_loss_weight: 0.0
    mask_inv_dt_loss_weight: 1000.0
    rgb_loss_weight: 1.0
    dino_feat_im_loss_weight: 10.0
    sdf_reg_decay_start_iter: 10000
    sdf_bce_reg_loss_weight: 0.0
    sdf_gradient_reg_loss_weight: 0.1
    logit_loss_weight: 1.0
    logit_loss_dino_feat_im_loss_multiplier: 50.0
    arti_reg_loss_iter_range:
    - 60000
    - 'inf'
    arti_reg_loss_weight: 0.2
    deform_reg_loss_weight: 10.0
    logit_loss_dino_feat_im_loss_multiplier_dict:
      0: 50.0
      300000: 500.0
    dino_feat_im_loss_weight_dict:
      0: 10.0
      300000: 1.0
    logit_loss_mask_multiplier: 0.05
    logit_loss_mask_inv_dt_multiplier: 0.05
load_optim: false
output_dir: results/fauna/pretrained_fauna/visualization
render_modes:
- input_view
- other_views
- rotation
finetune_texture: false
finetune_iters: 10
finetune_lr: 0.001
evaluate_keypoint: false
